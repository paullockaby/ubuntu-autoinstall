#cloud-config
autoinstall:
  version: 1
  interactive-sections:
    - storage
    - network
  refresh-installer:
    update: true
  source:
    id: ubuntu-server
  locale: "en_US.UTF-8"
  timezone: Etc/UTC
  keyboard:
    layout: us
  updates: all
  shutdown: reboot
  kernel:
    flavor: hwe
  apt:
    fallback: offline-install
    disable_suites: [backports]
    disable_components: [restricted, multiverse]
    conf: |
      APT::Install-Recommends "false";
      APT::Install-Suggets "false";
  ssh:
    install-server: true
    allow-pw: false
  user-data:
    disable_root: true
    manage_etc_hosts: true
    users:
      - name: paul
        groups: [sudo]
        lock_passwd: true
        shell: /bin/bash
        sudo: ALL=(ALL) NOPASSWD:ALL
        ssh_authorized_keys:
          - ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJXa+XxzkIcpEUon/kJVn140DE/MlJylLxh0c50BHtjY paul@local
  storage:
    grub:
      reorder_uefi: false
    swap:
      size: 0
    layout:
      name: lvm
  packages:
    - less
    - vim
    - rsyslog
    - chrony
    - cron
  early-commands:
    - bash -c /cdrom/nocloud/commands-early.sh
  late-commands:
    - bash -c /cdrom/nocloud/commands-late.sh
